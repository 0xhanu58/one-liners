bash -c "clear; read -p $'\e[1;32mEnter Target IP [ \e[1;33m'"${NMAP_TARGET_IP:-NOT-SET-YET}"$' \e[1;32m]: \e[0m' input; NMAP_TARGET_IP=\${input:-\${NMAP_TARGET_IP}}; [[ \$NMAP_TARGET_IP =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}$ ]] || { echo -e '\e[1;31mError: Invalid IP address.\e[0m'; exit 1; }; sudo -v > /dev/null 2>&1 || { echo -e '\e[1;31mError: Sudo permissions required.\e[0m'; exit 1; }; echo -e '\n\n\e[1;32mRunning full port scan...\e[0m'; sudo nmap --min-rate=1500 -p- -Pn -vv -n \"\$NMAP_TARGET_IP\" -oN port.scan || { echo -e '\e[1;31mError: Port scan failed.\e[0m'; exit 1; }; [[ -f port.scan && -s port.scan ]] || { echo -e '\e[1;31mError: port.scan file is missing or empty.\e[0m'; exit 1; }; export NMAP_PORTS=\$(grep '^[0-9]' port.scan | awk -F/ '{print \$1}' | tr '\n' ',' | sed 's/,\$//'); [[ -z \"\$NMAP_PORTS\" ]] &&{ echo -e '\e[1;31mError: No open ports found, check port.scan file.\e[0m'; exit 1; }; echo -e \"\n\n\e[1;32m\nRunning Service Scan on Ports \$NMAP_PORTS\e[0m\"; printf '\n\e[0m'; sudo nmap -p \"\$NMAP_PORTS\" -A -vv -Pn -n \"\$NMAP_TARGET_IP\" -oN service.scan || { echo -e '\e[1;31mError: Service scan failed.\e[0m'; exit 1; }; echo -e '\n\n\e[1;31mNote: \e[1;32mFor output see \`\e[1;33mport.scan\e[1;32m\` and \`\e[1;33mservice.scan\e[1;32m\` in the same directory.\e[0m\n'"
